# Includes
include:
- project: tq-em/public/build/base
  file: ci/include.yml
  ref: v2.0.3
  rules:
    - if: '$BASE_CI_REF'
      when: never
    - if: '$CI_COMMIT_TAG'
    - if: '$CI_COMMIT_BRANCH =~ /^release/'
    - if: '$CI_MERGE_REQUEST_TARGET_BRANCH_NAME =~ /^release/'

- project: tq-em/public/build/base
  file: ci/include.yml
  ref: main
  rules:
    - if: '$BASE_CI_REF'
      when: never
    - if: '$CI_COMMIT_TAG'
      when: never
    - if: '$CI_COMMIT_BRANCH =~ /^release/'
      when: never
    - if: '$CI_MERGE_REQUEST_TARGET_BRANCH_NAME =~ /^release/'
      when: never
    - when: always

- project: tq-em/public/build/base
  file: ci/include.yml
  ref: $BASE_CI_REF
  rules:
    - if: $BASE_CI_REF

- local: 'ci/common/artifacts.yml'
- local: 'ci/common/deploy.yml'
- local: 'ci/common/images.yml'
- local: 'ci/common/variables.yml'
